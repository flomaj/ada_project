# In this part of the code we will use liner regression to observe the possible correlation between our variables 

#firstly we import some libraries we need 

import numpy as np
import pandas as pd
import seaborn as sns
import matplotlib.pyplot as plt
from sklearn import linear_model, metrics


# Then we read Data

data = pd.read_csv('dataset.csv')


# Define the scatter plots and the variables we want to regress, we didnt take into accoint google trends and volatility as the outcome was not optimal 

cols = ['closing_price','MVRV', 'txs_count', 'daily_active_adds', 'gwei']
sns.pairplot(data[cols], size=2.5)
plt.show()


# extract closing price
y = data.iloc[:,8].values

# extract daily adds
X = data.iloc[:,[3]].values
print(X.size)

# Make the plot 
g = sns.regplot(x=X, y=y, fit_reg=False)


# Implement the Linear Regression model 
reg = linear_model.LinearRegression()
reg.fit(X,y)
plt.plot(X, reg.predict(X), color='red')

# We name our labels 
plt.xlabel('Daily Adds')
plt.ylabel('Closing Price')
plt.show()

# Finally, we print the coefficients and R squared 
print('Parameters:')
print('w0: %f'%reg.intercept_)
print('w1: %f'%reg.coef_[0])
print('R2: %f'%metrics.r2_score(y,reg.predict(X)))

